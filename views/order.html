<!DOCTYPE html>

<html ng-app="venimos">

<head>
	<title>Order</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
    <script src="./javascripts/order.js"></script>
</head>

<body ng-controller="orderController">
	<!-- Lookup Address (if user has not joined order) -->
	<div ng-if="order === null && splitwiseUser !== null && lookupAddress === false">
		<form>
			<input type="text" placeholder="Street Address" ng-model="$parent.street" /><br />
			<input type="text" placeholder="City" ng-model="$parent.city" />,
			<input type="text" placeholder="State" ng-model="$parent.state" />
			<input type="number" placeholder="Zipcode" ng-model="$parent.zip" /><br />
			<button ng-click="$parent.searchAddress()">Look Up This Address</button>
		</form>
	</div>

	<!-- Choose address -->
	<div ng-if="order === null && splitwiseUser !== null && lookupAddress === true">
		<ul ng-repeat="store in $parent.addresses">
			<li ng-click="$parent.chooseStore(store.StoreID)">{{store.AddressDescription}}</li>
		</ul>
		<button ng-click="$parent.lookupAddress = false">Go back</button>
	</div>

	<!-- Menu from store -->
	<div ng-if="order !== null">
		<h1>Coupons</h1>
		<ul ng-repeat="coupon in $parent.coupons">
			<li ng-if="coupon.Tags.Days === undefined || $parent.couponAvailable(coupon.Tags.Days)" ng-click="$parent.selectCoupon(coupon.Code)">
				{{coupon.Name}}<span ng-if="coupon.Price != ''"> (${{coupon.Price}})
			</li>
		</ul>

		<h1>Products</h1>
		<div ng-repeat="productKey in $parent.productKeys">
			<h2>{{productKey}}</h2>
			<ul ng-repeat="product in $parent.products[productKey]">
				<li>
					{{product.Name}}<br />-- {{product.Description}}
					<ul ng-repeat="variant in product.Variants">
						<li ng-click="$parent.addToOrder($parent.variants[variant].Code, $parent.variants[varient].Price)">
							{{$parent.variants[variant].Name}} -- ${{$parent.variants[variant].Price}}
						</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
</body>

</html>